\begin{figure}[htbp]
\centering
\begin{tikzpicture}[
    scale=1.1,
    box/.style={rectangle, draw=black!70, rounded corners=3pt, 
               fill=white, text width=3cm, align=center, minimum height=1cm,
               pattern=#1, pattern color=black!20,
               drop shadow={opacity=0.15, shadow xshift=0.5mm, shadow yshift=-0.5mm}},
    arrow/.style={->, >=stealth, thick, draw=black!70},
    dashed_arrow/.style={->, >=stealth, thick, dashed, draw=black!70}
]

% Oracle Components with increased vertical spacing
\node[box=north east lines] (contract) at (0,5) {Smart Contract};
\node[box=crosshatch] (oracle) at (0,0) {Oracle Service};

% Data Sources - Increased horizontal and vertical spacing
\node[box=dots, text width=2cm] (price) at (-6,-3) {Price Data};
\node[box=dots, text width=2cm] (random) at (-3,-3) {Random};
\node[box=dots, text width=2cm] (weather) at (0,-3) {Weather};
\node[box=dots, text width=2cm] (sports) at (3,-3) {Sports};
\node[box=dots, text width=2cm] (custom) at (6,-3) {Custom};

% External Systems - Moved down to avoid arrow crossings
\node[box=grid] (external) at (0,-6) {External Data Sources};

% Main flow arrows with better positioned labels
\draw[arrow] (contract) -- node[above-arrow-text, left, pos=0.3] {1. Request} (oracle);
\draw[dashed_arrow] (oracle) -- node[above-arrow-text, right, pos=0.7] {4. Response} (contract);

% Query arrows with properly positioned labels
\draw[arrow] (oracle) -- node[above-arrow-text, sloped, pos=0.3] {2. Query} (price);
\draw[arrow] (oracle) -- node[above-arrow-text, sloped, pos=0.3] {2. Query} (random);
\draw[arrow] (oracle) -- node[above-arrow-text, pos=0.3] {2. Query} (weather);
\draw[arrow] (oracle) -- node[above-arrow-text, sloped, pos=0.3] {2. Query} (sports);
\draw[arrow] (oracle) -- node[above-arrow-text, sloped, pos=0.3] {2. Query} (custom);

% Data source connections with angled paths
\draw[arrow] (price) -- node[above-arrow-text, sloped, pos=0.7] {Source Data} (external);
\draw[arrow] (random) -- node[above-arrow-text, sloped, pos=0.7] {Source Data} (external);
\draw[arrow] (weather) -- node[above-arrow-text, pos=0.7] {Source Data} (external);
\draw[arrow] (sports) -- node[above-arrow-text, sloped, pos=0.7] {Source Data} (external);
\draw[arrow] (custom) -- node[above-arrow-text, sloped, pos=0.7] {Source Data} (external);

% Data return arrow with better label position
\draw[dashed_arrow] (external) -- node[above-arrow-text, right, pos=0.3] {3. Data} (oracle);

% Title with increased weight for visibility
\node[text width=4cm, align=center, font=\bfseries] at (0,7) {Oracle Service};

\end{tikzpicture}
\caption{Oracle Service Architecture}
\label{fig:oracle-architecture}
\end{figure}
