% This file should only be \input{} in a document that loads the tikz package
% Do not compile this file directly with pdflatex

\begin{figure}[ht]
\centering
\begin{tikzpicture}[
    box/.style={rectangle, draw, rounded corners, fill=white, 
               minimum width=2cm, minimum height=1cm, text centered},
    line/.style={-latex, thick}
]
    % Nodes
    \node[box, fill=blue!10] (app) at (0,4) {Application};
    \node[box, fill=green!10] (enclave) at (0,2) {Trusted Enclave};
    \node[box, fill=red!10] (blockchain) at (0,0) {Blockchain};
    
    % Components inside TEE
    \node[box, fill=yellow!10, minimum width=1.5cm, minimum height=0.8cm] (processor) 
         at (-1,2) {Secure Processor};
    \node[box, fill=yellow!10, minimum width=1.5cm, minimum height=0.8cm] (memory) 
         at (1,2) {Encrypted Memory};
         
    % Draw a box around TEE components
    \draw[dashed] (-2.5,1) rectangle (2.5,3);
    
    % Connections
    \draw[line] (app) -- node[above-arrow-text] {Encrypted Data} (enclave);
    \draw[line] (enclave) -- node[above-arrow-text] {Verified Results} (blockchain);
    \draw[line] (processor) -- node[above-arrow-text, right] {Secure Operations} (memory);
    
    % Additional note
    \draw[->] (3,2.5) -- (2.3,2.5);
    \draw[->] (3,1.5) -- (2.3,1.5);
    \node[above-arrow-text] at (2.8,3.5) {Hardware Protection};
\end{tikzpicture}
\caption{Trusted Execution Environment Service}
\label{fig:tee-service}
\end{figure}
